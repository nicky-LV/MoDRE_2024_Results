import matplotlib.pyplot as plt
import seaborn as sns
import RDMSimExemplar.Additional_Resources.Additional_Resources.RDMSim_Python.SimpleSimulationExample.rdm_sim.Config as config
import pandas as pd
import numpy as np

class POMDPGraphs:
    def __init__(self, pomdp):
        self.pomdp = pomdp

    def action_count_bar_chart(self):
        bar_positions = [1, 2]
        plt.bar(
            bar_positions,
            [self.pomdp.actions_chosen["MST"], self.pomdp.actions_chosen["RT"]],
        )
        plt.xlabel("Action Chosen")
        plt.ylabel("Frequency")
        plt.title(
            f"{self.get_scenario_label()} {self.get_pomdp_label()} Actions Chosen"
        )
        plt.xticks(bar_positions, ("MST", "RT"))
        plt.show()

    def state_counts_bar_chart(self):
        state_labels = list(self.pomdp.S.keys())
        bar_positions = [i for i in range(1, len(state_labels) + 1)]
        bar_heights = [self.pomdp.state_counts[s] for s in state_labels]
        plt.bar(bar_positions, bar_heights)
        plt.xlabel("State Visited")
        plt.ylabel("Frequency")
        plt.title(
            f"{self.get_scenario_label()} {self.get_pomdp_label()} States Visited"
        )
        plt.xticks(bar_positions, labels=state_labels)
        plt.show()

    def plot_surprise(self):
        plt.plot(self.pomdp.states_surprise_log)
        plt.xlabel("Step")
        plt.ylabel("Surprise")
        plt.title(
            f"{self.get_scenario_label()} {self.get_pomdp_label()} Surprise over time"
        )
        plt.show()

    def plot_novelty(self):
        plt.plot(self.pomdp.novelty_log)
        plt.xlabel("Step")
        plt.ylabel("Novelty")
        plt.title(
            f"{self.get_scenario_label()} {self.get_pomdp_label()} Novelty over time"
        )
        plt.show()

    def plot_transition_heatmap(self):
        # row = prev state
        # col = transitioned state
        fig, ax = plt.subplots()
        total = 0
        data = [[0] * len(self.pomdp.S) for _ in range(len(self.pomdp.S))]
        for (s_prime, s, action), count in self.pomdp.transition_counts.items():
            s_prime_idx = list(self.pomdp.S.keys()).index(s_prime)
            s_idx = list(self.pomdp.S.keys()).index(s)
            data[s_idx][s_prime_idx] += count
            total += count

        print(f"TOTAL TRANSITIONS: {total}")

        sns.heatmap(data, annot=True, cmap="YlGnBu", fmt="d")
        ax.set_xticklabels(["S0", "S1", "S2", "S3", "S4", "S5", "S6", "S7"])
        ax.set_yticklabels(["S0", "S1", "S2", "S3", "S4", "S5", "S6", "S7"])
        ax.set_ylabel("From State")
        ax.set_xlabel("To State")
        plt.title(
            f"{self.get_scenario_label()} {self.get_pomdp_label()} Transition Counts"
        )
        plt.show()

    def get_scenario_label(self) -> str:
        return f"[Scenario {config.scenario}]"

    def get_pomdp_label(self) -> str:
        if self.pomdp.unsupervised:
            return "[Unsupervised]"
        return "[Expert Informed]"

    def plot_box_plots_bw(self):
        """
        Supervised expert-defined
        data = {
            "S0": [5070.0, 3150.0, 3744.0, 1053.0, 5226.0, 1518.0, 5700.0, 3525.0, 4860.0, 2430.0, 4950.0, 2310.0, 6390.0, 3825.0, 3354.0, 3825.0, 1800.0, 5508.0, 2664.0, 4032.0, 4125.0, 840.0, 4485.0, 1560.0, 4368.0, 2550.0, 5037.0, 2142.0, 4650.0, 1200.0, 5325.0, 3915.0, 1014.0, 5796.0, 4290.0, 1260.0, 4992.0, 1008.0, 3864.0, 2709.0, 4875.0, 1200.0, 5913.0, 4524.0, 1584.0, 4785.0, 3978.0, 2436.0, 6003.0, 3630.0, 1425.0, 6474.0, 3024.0, 3825.0, 3588.0, 3960.0, 924.0, 4473.0, 2940.0, 5880.0, 2856.0, 5832.0, 693.0, 3828.0, 3828.0, 2640.0, 4455.0, 567.0, 4770.0, 3828.0, 3276.0, 5829.0, 2184.0, 6075.0, 1740.0, 3720.0, 4002.0, 4320.0, 1560.0, 4680.0, 2160.0, 3690.0, 1764.0, 4860.0, 1080.0, 7134.0, 3180.0, 4275.0, 3630.0, 1953.0, 4320.0, 3564.0, 4356.0, 3000.0, 2520.0, 6525.0, 1932.0, 4761.0, 1863.0, 3480.0],
            "S1": [4800.0, 3432.0, 4290.0, 5382.0, 4725.0, 4320.0, 2574.0, 4620.0, 874.0, 6438.0, 5712.0, 1426.0, 4056.0, 3190.0, 5040.0, 4350.0, 1288.0, 4950.0, 2880.0, 6300.0, 4131.0, 4575.0, 2150.0, 6972.0, 3969.0, 2850.0, 4920.0, 3900.0, 6132.0, 4260.0, 5100.0, 1224.0, 5037.0, 840.0, 5325.0, 4950.0, 1702.0, 6720.0, 5568.0, 3068.0, 3366.0, 5016.0, 4968.0, 3825.0, 3080.0, 5148.0, 3074.0, 4500.0, 4914.0, 3660.0, 1460.0, 5658.0, 4020.0, 4050.0, 1326.0, 6840.0, 5082.0, 3420.0, 4554.0, 5307.0, 4620.0, 3504.0, 5625.0, 5913.0, 4941.0, 2436.0, 5040.0, 714.0, 7221.0, 875.0, 6318.0, 3888.0, 782.0, 4284.0, 2808.0, 5478.0, 3975.0, 3496.0, 6090.0, 5427.0, 2044.0, 5100.0, 2208.0, 5544.0, 5124.0, 5307.0, 3750.0, 2992.0, 3900.0, 2457.0, 5451.0, 4104.0, 2025.0, 5184.0, 1274.0, 4392.0, 5325.0, 5688.0, 4992.0, 4761.0],
            "S2": [4714.080000000001, 1512.0, 4986.75, 3402.0, 6299.700000000001, 1440.0, 5294.700000000001, 1827.0, 6121.4400000000005, 2400.0, 6893.1, 2838.0, 4868.64, 1260.0, 7063.200000000001, 4524.0, 4872.0, 2760.0, 5591.070000000001, 2967.0, 4322.34, 1092.0, 6901.4400000000005, 3675.0, 3498.0, 5544.000000000001, 2340.0, 5247.0, 756.0, 3702.6000000000004, 726.0, 7714.56, 2772.0, 504.0, 6923.070000000001, 825.0, 4630.320000000001, 3696.0, 3654.0, 3360.0, 3829.5000000000005, 1560.0, 4065.6000000000004, 966.0, 5034.96, 1980.0, 6268.59, 1092.0, 5346.0, 2430.0, 4495.5, 2610.0, 5890.77, 693.0, 7012.9800000000005, 3360.0, 6153.84, 3402.0, 7050.120000000001, 819.0, 5454.540000000001, 3120.0, 4761.120000000001, 3225.0, 3000.0, 5594.400000000001, 4104.0, 3276.0, 4249.08, 2160.0, 4933.5, 660.0, 6546.540000000001, 3132.0, 6867.000000000001, 3234.0, 5104.89, 2442.0, 3529.8, 6041.280000000001, 3276.0, 5837.700000000001, 2754.0, 4761.120000000001, 4104.0, 3339.0, 5755.200000000001, 3588.0, 6237.000000000001, 2448.0, 6909.750000000001, 552.0, 5209.110000000001, 2079.0, 5308.8, 1224.0, 5577.6, 3888.0, 2772.0, 3432.0],
            "S3": [4615.38, 1600.0, 6493.500000000001, 1580.0, 3763.2000000000003, 2709.0, 6890.400000000001, 1980.0, 6699.000000000001, 609.0, 5915.43, 3344.0, 5221.4400000000005, 3775.0, 2760.0, 5886.72, 2310.0, 6027.84, 1856.0, 5594.400000000001, 1408.0, 3809.5200000000004, 598.0, 4172.52, 800.0, 6573.6, 2214.0, 7259.400000000001, 1428.0, 5503.68, 2088.0, 4235.76, 2670.0, 4757.76, 3712.0, 1738.0, 6625.920000000001, 1073.0, 6289.920000000001, 2080.0, 3828.0000000000005, 1680.0, 7372.620000000001, 1710.0, 3924.0000000000005, 1053.0, 6327.000000000001, 4408.0, 1080.0, 4573.8, 1750.0, 6768.900000000001, 2520.0, 5964.4800000000005, 1716.0, 4633.200000000001, 3750.0, 1600.0, 5627.700000000001, 4031.0, 3050.0, 7192.8, 2943.0, 6393.6, 805.0, 5820.84, 1421.0, 6370.56, 2210.0, 3793.2000000000003, 2254.0, 4211.76, 1008.0, 5376.000000000001, 1541.0, 4986.240000000001, 2700.0, 6131.25, 3213.0, 5650.56, 1550.0, 7656.000000000001, 2900.0, 5853.120000000001, 2877.0, 2500.0, 4329.0, 768.0, 6003.72, 2784.0, 5953.200000000001, 441.0, 3956.0400000000004, 1518.0, 4839.6, 3276.0, 7049.610000000001, 2117.0, 5201.46, 2772.0],
            "S4": [4026.0, 6162.0, 6084.0, 5832.0, 2887.5000000000005, 3969.0, 4368.0, 816.96, 6660.0, 6396.0, 4347.0, 1412.64, 4380.0, 5037.0, 5538.0, 3900.0, 957.0000000000001, 6840.0, 5175.0, 4950.0, 2721.6000000000004, 7290.0, 5538.0, 5103.0, 4860.0, 5913.0, 2816.0, 4608.0, 3386.88, 4554.0, 3498.0, 4209.0, 5040.0, 4968.0, 3276.0, 6384.0, 2777.32, 5727.0, 4290.0, 3969.0, 6120.0, 457.8, 5166.0, 6075.0, 3588.0, 4032.0, 2476.4100000000003, 4959.0, 4608.0, 3000.0, 4681.6, 4284.0, 4354.56, 1068.2, 7221.0, 6300.0, 2268.84, 4284.0, 1905.3200000000002, 4488.0, 7221.0, 5280.0, 4698.0, 2439.36, 4725.0, 5850.0, 3309.2400000000002, 4608.0, 1344.0000000000002, 3150.0, 6972.0, 6642.0, 5796.0, 3662.4, 3355.0200000000004, 4992.0, 5280.0, 7290.0, 6399.0, 5832.0, 6960.0, 2655.1200000000003, 3000.0, 3465.0, 5208.0, 5481.0, 4698.0, 634.9200000000001, 5220.0, 4437.0, 5003.1, 7200.0, 4662.0, 3570.84, 5040.0, 3931.6200000000003, 1386.0, 5106.0, 4392.0, 3161.0000000000005],
            "S5": [4050.0, 2106.0, 4242.42, 3480.0, 6566.76, 3933.0, 4368.0, 3780.0, 1008.0, 3760.5000000000005, 1584.0, 5890.360000000001, 2376.0, 3840.6000000000004, 2880.0, 4862.0, 4050.0, 2484.0, 2376.0, 4263.51, 2520.0, 4278.25, 2352.0, 5798.8, 3330.0, 5106.0, 2184.0, 4461.6, 3384.0, 5466.750000000001, 3180.0, 3780.0000000000005, 3024.0, 4042.5000000000005, 3750.0, 1449.0, 5271.240000000001, 2100.0, 4373.400000000001, 4446.0, 3654.0, 1890.0, 4307.68, 4089.0, 2970.0, 6182.400000000001, 3780.0, 3795.0, 1827.0, 3993.0000000000005, 4320.0, 3825.0, 3045.0, 4804.8, 1794.0, 4730.88, 3078.0, 4041.4000000000005, 1092.0, 5827.500000000001, 2460.0, 1104.0, 4250.400000000001, 1134.0, 4559.88, 3969.0, 3276.0, 1656.0, 4978.35, 1458.0, 3539.2000000000003, 4129.200000000001, 780.0, 5292.000000000001, 1638.0, 5762.01, 3108.0, 4598.0, 3591.0, 6244.860000000001, 1638.0, 3547.9500000000003, 6888.000000000001, 2262.0, 5623.200000000001, 3300.0, 3825.0, 2496.0, 5199.700000000001, 2430.0, 4412.1, 1197.0, 4646.46, 3168.0, 3310.0200000000004, 3719.1000000000004, 1827.0, 3360.0000000000005, 3630.0, 3042.0],
            "S6": [1858.0800000000002, 4484.26, 2441.6000000000004, 4102.56, 2851.2000000000003, 4656.96, 2913.57, 5314.84, 1147.77, 4547.200000000001, 3136.0000000000005, 5104.89, 660.0, 6592.320000000001, 2106.78, 5034.96, 725.7600000000001, 4506.6, 3203.2000000000003, 5555.0, 708.5, 5765.76, 4096.400000000001, 1742.4, 5665.4400000000005, 3296.1600000000003, 6986.1, 952.0000000000001, 6669.71, 3480.4, 4752.0, 4551.84, 3225.6000000000004, 6445.17, 3810.6400000000003, 1008.0000000000001, 5051.200000000001, 645.1200000000001, 4636.8, 1844.64, 6033.150000000001, 1443.0000000000002, 3252.4800000000005, 4501.200000000001, 1811.0400000000002, 6240.64, 756.0000000000001, 4307.6, 1226.25, 5461.200000000001, 3418.8, 3225.6000000000004, 3644.9600000000005, 1779.97, 5057.6, 1611.7200000000003, 4382.280000000001, 5066.88, 1716.0000000000002, 4650.240000000001, 2710.4, 4730.0, 2562.5600000000004, 5857.500000000001, 3363.3, 4838.400000000001, 4795.200000000001, 3655.6800000000003, 3480.9600000000005, 5940.4800000000005, 1680.0000000000002, 4905.0, 3888.6400000000003, 3116.9600000000005, 6540.000000000001, 1094.46, 3534.3, 5334.660000000001, 1732.5000000000002, 4422.240000000001, 3335.4, 4467.75, 3189.34, 5187.84, 669.7600000000001, 4912.6, 3036.9600000000005, 3076.92, 2237.76, 3735.2000000000003, 3682.8, 3932.5000000000005, 3832.4, 4319.84, 1181.0400000000002, 5434.0, 3405.4800000000005, 6289.920000000001, 3646.7200000000003, 2026.8600000000001]
        }
        """

        # Unsupervised vanilla
        data = {
            "S0": [2964.0, 1740.0, 4554.0, 2784.0, 5580.0, 2106.0, 4275.0, 3900.0, 1653.0, 3840.0, 4611.0, 2304.0, 4200.0, 960.0, 6561.0, 1350.0, 4209.0, 4872.0, 3672.0, 2856.0, 5688.0, 3306.0, 4221.0, 1080.0, 6804.0, 1173.0, 6552.0, 3132.0, 3096.0, 5082.0, 4368.0, 900.0, 6120.0, 1872.0, 5832.0, 3330.0, 6003.0, 3828.0, 3240.0, 3795.0, 3744.0, 1794.0, 6000.0, 2583.0, 5544.0, 3588.0, 4200.0, 1782.0, 4221.0, 1134.0, 4320.0, 3402.0, 4779.0, 4437.0, 3375.0, 4500.0, 840.0, 5412.0, 3762.0, 1512.0, 4914.0, 936.0, 4950.0, 5046.0, 4134.0, 3807.0, 594.0, 4950.0, 1584.0, 3600.0, 6750.0, 1320.0, 4440.0, 2673.0, 4950.0, 2349.0, 4176.0, 2970.0, 6000.0, 2829.0, 5103.0, 5046.0, 3300.0, 6438.0, 810.0, 5850.0, 900.0, 5256.0, 2205.0, 5133.0, 1173.0, 6972.0, 621.0, 6612.0, 4455.0, 2430.0, 4800.0, 1800.0, 4899.0, 2760.0],
            "S1": [4872.0, 4032.0, 1792.0, 2596.0, 780.0, 4500.0, 3752.0, 2090.0, 3900.0, 2522.0, 2912.0, 638.0, 3074.0, 3058.0, 4380.0, 2268.0, 4212.0, 812.0, 702.0, 3576.0, 4725.0, 4408.0, 4785.0, 483.0, 3040.0, 840.0, 1620.0, 1978.0, 1173.0, 2772.0, 6840.0, 1479.0, 1701.0, 3276.0, 2222.0, 4284.0, 4485.0, 4824.0, 2660.0, 2943.0, 4779.0, 1170.0, 4560.0, 4200.0, 2604.0, 1980.0, 940.0, 2783.0, 4560.0, 1260.0, 1404.0, 3074.0, 2070.0, 1092.0, 567.0, 3843.0, 2222.0, 1776.0, 756.0, 3540.0, 2840.0, 4422.0, 3289.0, 800.0, 5481.0, 3060.0, 4830.0, 5307.0, 2480.0, 667.0, 6132.0, 6384.0, 2088.0, 1540.0, 6786.0, 2212.0, 1008.0, 3146.0, 4968.0, 3276.0, 4554.0, 1416.0, 1955.0, 4446.0, 3366.0, 2268.0, 3059.0, 2262.0, 3792.0, 884.0, 4260.0, 2486.0, 1316.0, 3654.0, 6480.0, 3312.0, 6636.0, 5346.0, 5040.0, 3894.0],
            "S2": [4839.6, 5754.240000000001, 567.0, 3498.0000000000005, 7163.52, 2904.0, 4135.860000000001, 1131.0, 3375.0, 4452.0, 5251.620000000001, 2961.0, 4950.0, 6153.84, 1305.0, 2961.0, 2277.0, 4900.5, 3696.0000000000005, 2958.0, 3696.0, 7524.000000000001, 2904.0, 3960.0, 3432.0, 2829.0, 1728.0, 4828.5, 3276.0, 4175.820000000001, 3168.0, 8087.52, 5080.320000000001, 2775.0, 4633.200000000001, 3675.0, 5873.280000000001, 2310.0, 1512.0, 2139.0, 4708.8, 690.0, 5412.0, 4828.5, 2886.0, 4140.0, 2436.0, 6926.400000000001, 8265.6, 5108.22, 960.0, 5306.400000000001, 4515.84, 4395.6, 1320.0, 3312.0, 7526.400000000001, 4611.0, 5791.500000000001, 3366.0, 2592.0, 1860.0, 2175.0, 1020.0, 2625.0, 5221.4400000000005, 2760.0, 3750.0, 1440.0, 5412.0, 7599.4800000000005, 4296.6, 3864.0, 2331.0, 5046.0, 3339.0, 5715.360000000001, 7056.000000000001, 6955.200000000001, 5310.4800000000005, 5794.200000000001, 5361.3, 4263.0, 1296.0, 4139.52, 6753.6, 4356.0, 5009.400000000001, 4435.200000000001, 1482.0, 4120.200000000001, 1224.0, 720.0, 1125.0, 5003.1, 1656.0, 3219.0, 3393.0, 2622.0, 6023.97],
            "S3": [3750.0, 667.0, 3267.0, 1320.0, 5221.4400000000005, 1058.0, 4705.8, 768.0, 3848.0, 1632.0, 1508.0, 7192.8, 4708.8, 7273.200000000001, 1500.0, 6134.52, 3942.0, 6393.6, 3404.0, 1944.0, 7795.200000000001, 6955.200000000001, 1863.0, 3024.0, 1176.0, 1218.0, 2552.0, 1932.0, 5100.4800000000005, 2596.0, 3336.0, 3996.0000000000005, 4315.68, 5395.5, 3300.0, 6833.160000000001, 3197.0, 2700.0, 7038.900000000001, 6313.68, 7217.1, 7301.910000000001, 7306.200000000001, 667.0, 3472.0, 6091.8, 5490.330000000001, 1682.0, 1995.0, 2184.0, 2625.0, 6670.8, 6007.320000000001, 8366.400000000001, 2325.0, 4470.0, 3151.0, 903.0, 4336.02, 552.0, 5744.250000000001, 1496.0, 3432.0, 1344.0, 5683.26, 3552.0, 6603.3, 5396.160000000001, 736.0, 3150.0, 2030.0, 6206.46, 2640.0, 6468.000000000001, 441.0, 6679.68, 5256.900000000001, 6552.000000000001, 2640.0, 2964.0, 7435.89, 1242.0, 1218.0, 3770.0, 3648.0, 2760.0, 2100.0, 6620.040000000001, 714.0, 1798.0, 4745.25, 2904.0, 990.0, 3480.0, 2940.0, 4421.04, 4855.950000000001, 5241.6, 1363.0, 5347.9800000000005],
            "S4": [4368.0, 4290.0, 4176.0, 5313.0, 3564.0, 4347.0, 3300.0, 3300.0, 4455.0, 3888.0, 2328.48, 3255.8300000000004, 2158.2000000000003, 4440.0, 4575.0, 6399.0, 4692.0, 4109.3, 599.4000000000001, 1480.7400000000002, 4704.0, 3916.0800000000004, 3252.4800000000005, 6561.0, 6480.0, 2109.0, 887.2600000000001, 4818.0, 3927.1800000000003, 3540.32, 3432.0, 4350.0, 5694.0, 5655.0, 2074.59, 5490.0, 1848.0000000000002, 4368.0, 4590.0, 4342.8, 6804.0, 3978.0, 5670.0, 1925.0000000000002, 3473.1900000000005, 2475.0, 2665.6000000000004, 4092.0000000000005, 3845.6000000000004, 3960.0, 2040.4800000000002, 5100.0, 2352.0, 701.8000000000001, 1998.7000000000003, 1030.0500000000002, 669.9000000000001, 5475.0, 6090.0, 5382.0, 2040.4800000000002, 2752.25, 4140.0, 3030.3, 1568.0000000000002, 5124.0, 4536.0, 3420.0, 4176.0, 5994.0, 5304.0, 3540.0, 4968.0, 5472.0, 7200.0, 5481.0, 6084.0, 1609.5000000000002, 5478.0, 1663.2, 5070.0, 3144.9600000000005, 4623.0, 3285.26, 3339.0, 6240.0, 627.84, 5589.0, 5712.0, 2884.1400000000003, 4725.0, 1203.3600000000001, 5850.0, 3259.2000000000003, 4795.200000000001, 1798.2, 1955.46, 4134.0, 3752.9100000000003, 5130.0],
            "S5": [1020.0, 3432.0, 4617.0, 1827.0, 3168.0, 4200.0, 2106.0, 3510.0, 1800.0, 3510.0, 5236.0, 3300.0, 3456.0, 4629.900000000001, 2880.0, 696.0, 2448.0, 3612.0, 2940.0, 4752.0, 2523.0, 5562.27, 4585.410000000001, 729.0, 1134.0, 3741.0, 1560.0, 6385.22, 3498.0, 3042.0, 4662.0, 3498.0, 5775.84, 1254.0, 4449.38, 4979.52, 2280.0, 5322.240000000001, 5650.56, 3158.4, 1650.0, 1890.0, 2958.0, 4301.92, 5040.000000000001, 3960.0, 4884.0, 4536.0, 3300.0, 2475.0, 3105.0, 1176.0, 1620.0, 4188.8, 1716.0, 975.0, 2442.0, 5644.8, 1800.0, 2205.0, 5363.6, 4741.92, 3864.0000000000005, 3213.0, 5183.360000000001, 1380.0, 720.0, 3960.0000000000005, 4090.7700000000004, 5691.400000000001, 4290.0, 1200.0, 4524.0, 3364.9, 5035.8, 1104.0, 4455.360000000001, 4831.200000000001, 4151.400000000001, 4984.1, 3933.0, 4704.0, 3564.0, 3410.0000000000005, 2886.0, 4005.7500000000005, 3775.2000000000003, 2205.0, 3415.5000000000005, 1530.0, 1512.0, 4692.450000000001, 1701.0, 3674.0000000000005, 4595.400000000001, 3736.32, 4186.56, 3756.2400000000002, 4895.1, 4312.35],
            "S6": [993.3000000000001, 2024.0000000000002, 1144.5, 3424.9600000000005, 2851.2000000000003, 3089.0600000000004, 4682.64, 3187.8, 882.9000000000001, 1317.1200000000001, 3622.0800000000004, 3627.5200000000004, 2304.96, 5443.200000000001, 772.2, 1636.14, 1444.25, 4120.320000000001, 2775.0000000000005, 4681.6, 4764.120000000001, 4617.6, 1081.92, 5940.000000000001, 1384.17, 824.0400000000001, 5781.360000000001, 1068.2, 3974.8800000000006, 924.0000000000001, 5203.52, 2079.0, 2180.0, 3601.9200000000005, 4684.200000000001, 3976.32, 2129.6000000000004, 3063.6000000000004, 2143.6800000000003, 3418.8, 5179.68, 4155.84, 3746.2500000000005, 3181.71, 6563.43, 1142.4, 1471.5, 6405.81, 3326.4, 1068.2, 1753.8000000000002, 1021.2, 1708.0000000000002, 5469.200000000001, 3489.84, 2728.32, 7192.8, 1922.8000000000002, 2425.3500000000004, 2858.2500000000005, 1569.6000000000001, 5859.84, 3180.8, 2688.4, 765.1800000000001, 1264.4, 1460.6000000000001, 1895.88, 2310.8, 3315.78, 4326.21, 6160.000000000001, 5967.360000000001, 2695.84, 3171.84, 1694.0000000000002, 1904.7600000000002, 3612.0000000000005, 4381.4400000000005, 4822.160000000001, 2997.5, 4620.0, 1308.0, 915.6, 3203.2000000000003, 5385.6, 5394.6, 5034.96, 4027.5200000000004, 3670.2400000000002, 3751.8, 4404.96, 5772.000000000001, 2468.48, 2640.0, 781.44, 2153.8, 3448.76, 739.2, 2371.6000000000004]
        }

        # unsupervised with novelty
        data = {
            "S0": [1311.0, 1392.0, 3432.0, 2772.0, 2880.0, 4032.0, 3654.0, 1701.0, 1701.0, 4602.0, 5670.0, 2340.0, 3780.0, 4347.0, 990.0, 990.0, 1320.0, 2760.0, 1950.0, 1890.0, 4140.0, 2340.0, 2112.0, 3000.0, 3969.0, 4872.0, 4899.0, 2394.0, 480.0, 3564.0, 3900.0, 3567.0, 3300.0, 4176.0, 3420.0, 1566.0, 3780.0, 576.0, 4425.0, 1920.0, 3588.0, 660.0, 675.0, 4071.0, 4200.0, 858.0, 3000.0, 1620.0, 2610.0, 990.0, 2760.0, 2040.0, 4455.0, 5292.0, 1620.0, 975.0, 4800.0, 702.0, 5976.0, 3240.0, 3840.0, 1008.0, 2520.0, 1794.0, 1701.0, 1449.0, 3456.0, 1764.0, 4785.0, 2325.0, 2349.0, 3132.0, 2418.0, 2142.0, 3120.0, 3690.0, 2184.0, 4950.0, 3948.0, 2610.0, 5544.0, 3519.0, 4050.0, 5772.0, 729.0, 4410.0, 4368.0, 5460.0, 1440.0, 2622.0, 6480.0, 6474.0, 1512.0, 4374.0, 5928.0, 990.0, 4350.0, 6000.0, 3480.0, 4212.0],
            "S1": [690.0, 1775.0, 2250.0, 1700.0, 2958.0, 5412.0, 1120.0, 4320.0, 1728.0, 5913.0, 1080.0, 588.0, 4623.0, 1479.0, 1496.0, 2875.0, 3066.0, 3330.0, 920.0, 4872.0, 3192.0, 1978.0, 5670.0, 4956.0, 4818.0, 3857.0, 1725.0, 2680.0, 3537.0, 6570.0, 4623.0, 3960.0, 1595.0, 1344.0, 640.0, 4080.0, 6720.0, 4380.0, 5904.0, 4320.0, 770.0, 588.0, 4950.0, 5832.0, 4200.0, 2001.0, 3078.0, 1530.0, 1150.0, 2187.0, 3400.0, 4788.0, 5112.0, 2783.0, 3150.0, 2574.0, 3159.0, 4185.0, 2967.0, 4872.0, 4914.0, 2370.0, 2714.0, 3200.0, 2464.0, 3080.0, 2730.0, 5037.0, 3519.0, 3406.0, 1960.0, 6636.0, 1674.0, 4680.0, 2323.0, 5250.0, 4536.0, 5628.0, 1458.0, 1260.0, 6237.0, 3306.0, 2709.0, 4116.0, 5478.0, 1664.0, 989.0, 3289.0, 4080.0, 648.0, 3264.0, 1971.0, 840.0, 3750.0, 7134.0, 4050.0, 4290.0, 4818.0, 1058.0, 2919.0],
            "S2": [1914.0, 2886.0, 4104.0, 693.0, 5853.120000000001, 3690.0, 2349.0, 3600.0, 1518.0, 1134.0, 1425.0, 3510.0, 3991.6800000000003, 3933.0, 4867.5, 504.0, 1860.0, 924.0, 5800.860000000001, 6493.500000000001, 5493.6, 5974.02, 2997.0, 3654.0, 3795.0, 5082.0, 4704.0, 6177.6, 1500.0, 2520.0, 621.0, 6115.200000000001, 4891.92, 1440.0, 4680.0, 3612.0, 4944.240000000001, 648.0, 648.0, 3744.0, 2079.0, 5154.6, 2772.0, 2184.0, 7725.6, 3864.0, 5692.500000000001, 1377.0, 3168.0, 4172.52, 3060.0, 3045.0, 7092.900000000001, 3588.0, 5402.88, 4473.360000000001, 4717.4400000000005, 1482.0, 5934.06, 1530.0, 5227.200000000001, 6153.84, 3384.0, 5445.0, 5940.000000000001, 1152.0, 1458.0, 3600.0, 2331.0, 6918.240000000001, 3741.0, 5791.500000000001, 1008.0, 2088.0, 5266.8, 600.0, 6603.3, 3339.0, 1449.0, 1008.0, 4604.160000000001, 1701.0, 6949.8, 3102.0, 4136.55, 5544.0, 4131.0, 4989.6, 3510.0, 4155.84, 3300.0, 1848.0, 3465.0, 1008.0, 2331.0, 4172.52, 2964.0, 1512.0, 4536.0, 2760.0],
            "S3": [3996.0000000000005, 6993.000000000001, 6491.52, 1620.0, 2808.0, 2814.0, 1152.0, 7795.200000000001, 4455.0, 3388.0, 4139.52, 5194.8, 5564.160000000001, 3978.0, 3725.0, 4172.52, 4765.2300000000005, 6965.1, 3250.0, 3375.0, 6732.000000000001, 1624.0, 7207.200000000001, 3811.5000000000005, 6814.080000000001, 6410.250000000001, 2684.0, 2448.0, 3742.2000000000003, 3276.0, 7257.6, 5539.38, 4501.200000000001, 4502.160000000001, 2997.0, 5328.960000000001, 6237.000000000001, 4050.0, 1360.0, 4251.0, 4852.68, 7656.000000000001, 6072.000000000001, 729.0, 4986.75, 4136.55, 5577.0, 2668.0, 5078.700000000001, 6493.500000000001, 2992.0, 3914.1900000000005, 5114.88, 5591.700000000001, 5297.400000000001, 3952.0, 6134.52, 1470.0, 6663.330000000001, 5034.96, 4528.8, 3080.0, 2552.0, 2541.0, 2226.0, 2820.0, 3504.0, 760.0, 3836.0, 3400.0, 2834.0, 1404.0, 5896.8, 4249.08, 2541.0, 2725.0, 3993.0000000000005, 1590.0, 1960.0, 4806.900000000001, 1562.0, 2772.0, 609.0, 819.0, 4804.8, 609.0, 4250.400000000001, 5514.4800000000005, 6138.000000000001, 4595.400000000001, 5100.4800000000005, 3276.0, 5034.96, 5857.500000000001, 1170.0, 667.0, 2268.0, 3762.0000000000005, 5161.200000000001, 910.0],
            "S4": [5760.0, 3396.6000000000004, 5508.0, 4914.0, 3259.2000000000003, 4575.0, 1174.38, 4374.0, 2307.69, 5106.0, 3795.0000000000005, 2498.7200000000003, 3760.6800000000003, 4350.0, 564.48, 2331.0, 599.4000000000001, 3600.0, 876.96, 1087.9, 3655.86, 2066.6400000000003, 3052.0, 6156.0, 2360.6000000000004, 3303.3, 3141.6000000000004, 3825.0, 1518.0000000000002, 1110.0, 4330.570000000001, 3845.6000000000004, 1012.0000000000001, 1673.88, 5694.0, 582.4000000000001, 3717.0, 901.32, 2782.0800000000004, 3816.9600000000005, 5589.0, 4026.0, 3635.15, 2772.0, 3794.5600000000004, 3360.0, 1644.5000000000002, 4860.0, 4140.0, 3960.0, 4740.0, 2392.5, 4761.0, 3864.0, 1209.6000000000001, 7134.0, 4158.0, 4611.0, 3241.2000000000003, 5964.0, 3339.0, 4071.0, 3300.0, 3540.0, 5850.0, 3900.0, 3402.0, 4350.0, 3933.0, 5850.0, 6300.0, 5208.0, 5130.0, 5460.0, 1387.5000000000002, 4131.0, 1011.5200000000001, 1330.5600000000002, 3750.0, 6264.0, 6000.0, 6132.0, 4374.0, 4222.400000000001, 3240.0, 6699.0, 6237.0, 3835.7100000000005, 4536.0, 4209.0, 5580.0, 716.8000000000001, 3135.0000000000005, 4179.06, 3036.0000000000005, 4788.0, 5712.0, 6723.0, 4248.0, 4104.0],
            "S5": [1512.0, 1326.0, 3420.0, 3696.0, 2940.0, 6327.450000000001, 3828.0, 3075.0, 3192.0, 3120.0, 4131.0, 3480.0, 3816.0, 3180.0, 4120.200000000001, 3946.8, 4415.580000000001, 3300.0, 2760.0, 1131.0, 1638.0, 4176.0, 6888.000000000001, 4755.240000000001, 4717.5, 2232.0, 4566.54, 1827.0, 528.0, 2418.0, 4836.33, 2304.0, 4350.0, 4158.0, 6083.910000000001, 2604.0, 2001.0, 1020.0, 3960.0, 2520.0, 4186.56, 2688.0, 3654.0, 4186.56, 990.0, 4056.0, 4415.040000000001, 5591.070000000001, 1008.0, 6540.000000000001, 6713.280000000001, 3395.7000000000003, 1134.0, 3483.0, 1323.0, 3450.0, 1020.0, 3933.0, 2418.0, 4482.240000000001, 936.0, 1170.0, 3672.0, 5322.240000000001, 5244.750000000001, 3476.0000000000005, 1131.0, 6049.500000000001, 3520.0000000000005, 4704.0, 6237.000000000001, 5335.0, 5637.500000000001, 660.0, 5940.5, 3432.0, 4129.200000000001, 3120.0, 4452.0, 3654.0, 1425.0, 5761.8, 1320.0, 5119.400000000001, 6853.280000000001, 2376.0, 1620.0, 1587.0, 2775.0, 7259.400000000001, 1092.0, 2622.0, 4176.0, 5128.200000000001, 5460.900000000001, 1326.0, 2970.0, 4804.8, 3420.0, 3978.0],
            "S6": [5515.400000000001, 2582.21, 2634.2400000000002, 1442.1000000000001, 1452.0000000000002, 1748.2500000000002, 2354.4, 2517.48, 2041.6000000000001, 4932.84, 1554.0000000000002, 3812.4800000000005, 2331.51, 2702.7000000000003, 2634.2400000000002, 4962.77, 1065.6000000000001, 2727.2700000000004, 2822.4, 3313.6000000000004, 4315.68, 818.4000000000001, 4780.160000000001, 4102.56, 4421.04, 3165.36, 1276.0, 1602.3000000000002, 4515.84, 1888.1100000000001, 1617.0000000000002, 3885.0000000000005, 3885.0000000000005, 1749.0000000000002, 3889.4400000000005, 2504.32, 3574.2000000000003, 2610.7200000000003, 985.6800000000001, 1444.25, 3090.15, 2104.5600000000004, 865.8000000000001, 2354.4, 6012.4400000000005, 3692.92, 689.3100000000001, 2493.1200000000003, 2997.0000000000005, 4466.0, 3194.4, 2795.5200000000004, 3552.6400000000003, 4400.0, 5112.8, 3917.76, 2128.0, 3540.32, 3986.4000000000005, 1455.3000000000002, 5600.000000000001, 809.19, 1729.8300000000002, 5586.56, 1984.4, 4380.200000000001, 1736.0400000000002, 4666.200000000001, 4032.6000000000004, 5564.160000000001, 5203.52, 4162.400000000001, 4652.12, 4838.400000000001, 3605.8, 4263.51, 1572.4800000000002, 4648.0, 937.44, 4547.200000000001, 2531.2000000000003, 3566.4300000000003, 4829.4400000000005, 5089.21, 3256.0000000000005, 4320.120000000001, 5314.68, 3319.05, 5531.75, 6212.670000000001, 4190.25, 2502.5, 2508.8, 4767.660000000001, 6666.000000000001, 2813.2900000000004, 1670.97, 2207.25, 3125.76, 6534.000000000001]
        }
        threshold = [3600, 3600]
        self.plot_box_plot(data=data, threshold=threshold, ylabel="Bandwidth consumption")


    def plot_box_plots_ac(self):
        """
        Supervised expert-defined
        data = {
            "S0": [195, 105, 156, 39, 201, 69, 228, 141, 162, 81, 165, 105, 213, 153, 129, 153, 60, 204, 111, 192, 165, 42, 195, 60, 168, 102, 219, 102, 186, 60, 213, 135, 39, 207, 165, 60, 192, 42, 168, 129, 195, 60, 219, 174, 72, 165, 153, 87, 207, 165, 57, 249, 108, 153, 138, 180, 42, 213, 147, 210, 102, 243, 33, 174, 174, 132, 165, 27, 159, 174, 126, 201, 84, 243, 60, 186, 138, 144, 60, 195, 108, 123, 84, 243, 45, 246, 159, 171, 165, 93, 180, 162, 198, 120, 126, 225, 84, 207, 81, 174],
            "S1": [240, 156, 195, 234, 225, 180, 117, 165, 38, 222, 204, 62, 156, 110, 168, 174, 56, 225, 96, 210, 153, 183, 86, 249, 147, 95, 246, 156, 219, 213, 204, 51, 219, 42, 213, 165, 74, 240, 192, 118, 153, 228, 216, 153, 154, 234, 106, 225, 189, 122, 73, 246, 201, 162, 51, 228, 231, 171, 207, 183, 210, 146, 225, 219, 183, 116, 210, 34, 249, 35, 234, 162, 34, 204, 104, 249, 159, 152, 210, 201, 73, 204, 96, 231, 183, 183, 150, 136, 150, 91, 237, 171, 75, 216, 49, 183, 213, 237, 192, 207],
            "S2": [183, 63, 183, 162, 249, 48, 159, 63, 234, 120, 207, 129, 207, 60, 216, 156, 174, 138, 219, 129, 177, 42, 237, 147, 159, 198, 90, 159, 36, 153, 33, 246, 126, 24, 231, 33, 177, 168, 126, 120, 150, 78, 168, 42, 216, 99, 213, 42, 180, 81, 150, 87, 183, 33, 234, 120, 198, 126, 231, 39, 189, 120, 168, 129, 120, 168, 171, 156, 174, 90, 195, 33, 231, 108, 210, 147, 219, 111, 159, 186, 156, 183, 102, 156, 171, 159, 240, 138, 210, 102, 249, 24, 177, 99, 237, 51, 249, 144, 126, 132],
            "S3": [189, 80, 195, 79, 168, 129, 216, 99, 210, 21, 201, 152, 222, 151, 120, 219, 105, 234, 64, 168, 64, 156, 26, 174, 40, 249, 82, 222, 68, 189, 72, 159, 89, 177, 128, 79, 204, 37, 216, 104, 174, 56, 246, 57, 150, 39, 228, 152, 40, 189, 70, 207, 126, 228, 78, 162, 150, 64, 195, 139, 122, 240, 109, 240, 35, 228, 49, 237, 85, 174, 98, 168, 36, 192, 67, 159, 108, 225, 153, 216, 62, 240, 145, 201, 137, 125, 150, 32, 204, 116, 246, 21, 162, 69, 222, 126, 219, 73, 213, 132],
            "S4": [183, 237, 234, 216, 105, 189, 156, 32, 222, 246, 207, 48, 219, 219, 213, 195, 29, 228, 225, 225, 90, 243, 213, 243, 180, 219, 128, 192, 112, 198, 159, 183, 210, 216, 156, 228, 91, 249, 195, 189, 204, 21, 246, 225, 156, 192, 97, 171, 192, 150, 152, 153, 144, 35, 249, 225, 73, 153, 76, 204, 249, 240, 174, 99, 225, 225, 132, 192, 50, 150, 249, 246, 207, 120, 114, 192, 240, 243, 237, 216, 240, 104, 150, 165, 186, 189, 162, 26, 180, 153, 153, 240, 150, 117, 240, 154, 42, 222, 183, 116],
            "S5": [150, 81, 182, 174, 204, 171, 168, 126, 42, 150, 66, 193, 99, 173, 120, 221, 162, 108, 108, 167, 120, 157, 84, 190, 111, 200, 78, 156, 141, 197, 159, 135, 108, 147, 150, 69, 186, 75, 197, 171, 174, 63, 152, 141, 99, 184, 135, 165, 63, 165, 144, 153, 105, 143, 69, 176, 114, 167, 42, 210, 123, 48, 161, 42, 158, 147, 126, 69, 195, 54, 158, 186, 30, 189, 63, 179, 111, 190, 171, 194, 63, 155, 205, 87, 213, 150, 153, 96, 163, 81, 191, 57, 182, 144, 142, 161, 63, 150, 165, 117],
            "S6": [79, 187, 109, 176, 108, 154, 99, 212, 39, 145, 112, 219, 24, 218, 73, 216, 24, 145, 104, 202, 26, 198, 133, 66, 176, 109, 219, 34, 211, 113, 216, 144, 120, 219, 152, 36, 205, 24, 180, 61, 205, 50, 132, 186, 77, 199, 27, 178, 45, 205, 148, 144, 152, 71, 160, 66, 141, 156, 60, 173, 121, 215, 104, 213, 101, 216, 144, 136, 148, 221, 60, 180, 124, 121, 200, 34, 153, 178, 75, 166, 153, 175, 133, 193, 23, 203, 114, 132, 84, 145, 124, 143, 134, 133, 38, 190, 118, 208, 148, 83]
        }
        """

        # Unsupervised vanilla
        data = {
            "S0": [114, 60, 198, 96, 186, 81, 171, 150, 57, 192, 159, 96, 210, 48, 243, 45, 183, 174, 153, 102, 237, 114, 201, 45, 243, 51, 234, 108, 129, 231, 156, 30, 204, 72, 216, 111, 207, 132, 120, 165, 156, 78, 240, 123, 231, 156, 210, 81, 201, 54, 180, 162, 177, 153, 135, 150, 30, 246, 171, 72, 234, 39, 165, 174, 159, 141, 27, 165, 72, 150, 225, 66, 222, 99, 165, 87, 174, 135, 240, 123, 243, 174, 132, 222, 27, 234, 36, 219, 105, 177, 51, 249, 27, 228, 165, 81, 240, 75, 213, 120],
            "S1": [168, 192, 64, 118, 30, 150, 134, 95, 195, 97, 112, 29, 106, 139, 219, 108, 156, 29, 26, 149, 189, 152, 165, 21, 152, 40, 81, 86, 51, 132, 228, 51, 81, 117, 101, 153, 195, 201, 95, 109, 177, 45, 152, 150, 93, 99, 47, 121, 152, 60, 54, 106, 90, 42, 21, 183, 101, 74, 27, 118, 142, 201, 143, 40, 189, 102, 210, 183, 124, 23, 219, 228, 72, 70, 234, 79, 36, 121, 207, 156, 198, 59, 85, 171, 153, 108, 133, 78, 158, 34, 142, 113, 47, 174, 240, 144, 237, 243, 240, 177],
            "S2": [222, 216, 27, 159, 246, 132, 162, 39, 135, 159, 219, 141, 165, 198, 45, 141, 99, 165, 168, 102, 132, 228, 132, 165, 132, 123, 72, 150, 156, 171, 144, 249, 189, 111, 156, 147, 228, 105, 63, 93, 216, 30, 246, 174, 111, 138, 84, 240, 246, 177, 48, 201, 192, 165, 66, 138, 240, 159, 195, 153, 108, 93, 87, 51, 105, 168, 120, 150, 48, 246, 249, 186, 138, 111, 174, 159, 243, 225, 207, 174, 180, 210, 147, 54, 168, 201, 165, 207, 198, 57, 189, 51, 24, 45, 153, 69, 111, 117, 114, 201],
            "S3": [125, 29, 121, 44, 222, 46, 186, 32, 148, 68, 52, 216, 180, 228, 75, 201, 146, 192, 148, 72, 240, 207, 69, 144, 56, 58, 116, 69, 198, 118, 139, 150, 162, 198, 110, 228, 139, 90, 237, 237, 243, 231, 246, 23, 124, 213, 219, 58, 95, 91, 105, 204, 246, 249, 93, 149, 137, 43, 153, 23, 225, 68, 132, 56, 237, 148, 207, 219, 32, 126, 70, 219, 132, 210, 21, 213, 177, 195, 120, 114, 231, 46, 42, 130, 152, 92, 70, 213, 34, 62, 171, 121, 45, 116, 105, 156, 165, 180, 47, 219],
            "S4": [168, 165, 174, 231, 162, 189, 150, 165, 165, 162, 99, 103, 90, 222, 183, 237, 204, 145, 27, 58, 168, 126, 132, 243, 240, 95, 37, 219, 122, 109, 156, 174, 219, 195, 89, 183, 56, 168, 153, 141, 243, 153, 189, 70, 149, 90, 85, 124, 152, 165, 72, 204, 105, 29, 79, 35, 29, 219, 210, 207, 72, 101, 180, 130, 50, 183, 168, 171, 174, 222, 204, 177, 207, 228, 240, 189, 234, 50, 249, 56, 195, 104, 201, 137, 159, 240, 24, 243, 204, 126, 189, 48, 195, 97, 144, 81, 78, 159, 147, 171],
            "S5": [51, 156, 171, 87, 144, 150, 81, 135, 72, 135, 170, 132, 144, 183, 120, 24, 102, 129, 105, 144, 87, 189, 153, 27, 42, 129, 78, 202, 159, 117, 168, 159, 191, 57, 157, 171, 114, 176, 192, 141, 66, 63, 102, 167, 180, 132, 200, 162, 165, 99, 135, 42, 60, 136, 78, 39, 111, 210, 75, 105, 212, 178, 138, 153, 178, 60, 24, 180, 139, 199, 156, 60, 156, 133, 218, 48, 153, 183, 187, 197, 171, 200, 132, 155, 111, 175, 156, 105, 135, 51, 54, 205, 81, 167, 180, 139, 178, 141, 210, 185],
            "S6": [43, 80, 42, 139, 108, 109, 179, 138, 30, 42, 147, 128, 98, 162, 26, 67, 53, 128, 100, 152, 148, 160, 42, 216, 43, 27, 221, 35, 169, 40, 202, 90, 100, 134, 211, 152, 88, 92, 66, 110, 216, 156, 125, 139, 219, 51, 54, 199, 126, 49, 79, 40, 61, 226, 131, 87, 216, 76, 95, 103, 72, 192, 142, 94, 27, 40, 67, 61, 106, 117, 189, 200, 224, 83, 118, 70, 66, 129, 163, 158, 125, 168, 48, 35, 143, 204, 180, 189, 124, 113, 130, 171, 200, 76, 120, 32, 89, 113, 32, 98]
        }

        # unsupervised with novelty
        data = {
            "S0": [57, 48, 156, 132, 120, 168, 126, 81, 81, 177, 210, 90, 180, 189, 33, 45, 66, 138, 75, 63, 138, 117, 96, 150, 147, 168, 213, 114, 24, 132, 156, 123, 150, 174, 171, 54, 126, 24, 177, 96, 156, 33, 27, 177, 168, 39, 120, 60, 90, 33, 120, 102, 165, 189, 60, 39, 192, 27, 249, 120, 192, 42, 90, 69, 63, 69, 144, 84, 165, 93, 81, 108, 93, 102, 120, 123, 78, 165, 141, 87, 231, 153, 162, 222, 27, 210, 156, 195, 48, 114, 216, 249, 54, 162, 228, 33, 174, 240, 120, 162],
            "S1": [23, 71, 90, 85, 102, 246, 56, 216, 72, 219, 40, 21, 201, 51, 68, 125, 146, 111, 40, 174, 114, 86, 210, 177, 219, 133, 69, 134, 131, 219, 201, 132, 55, 56, 32, 204, 240, 219, 246, 144, 35, 21, 165, 243, 210, 87, 114, 51, 50, 81, 136, 171, 213, 121, 126, 117, 117, 155, 129, 174, 189, 79, 118, 128, 88, 140, 130, 219, 153, 131, 70, 237, 62, 156, 101, 210, 162, 201, 54, 42, 231, 114, 129, 147, 249, 64, 43, 143, 204, 24, 136, 73, 30, 150, 246, 162, 165, 219, 46, 139],
            "S2": [66, 111, 171, 33, 201, 123, 87, 120, 66, 54, 57, 117, 162, 171, 177, 24, 93, 42, 201, 234, 210, 234, 111, 174, 165, 210, 210, 234, 75, 126, 27, 195, 204, 60, 156, 129, 168, 24, 27, 156, 99, 213, 99, 84, 240, 168, 225, 51, 132, 174, 102, 105, 213, 156, 201, 171, 156, 57, 198, 51, 216, 231, 141, 225, 216, 48, 54, 144, 111, 213, 129, 195, 48, 72, 171, 30, 207, 159, 63, 48, 192, 63, 243, 141, 165, 210, 153, 216, 135, 156, 132, 84, 165, 48, 111, 174, 114, 63, 168, 120],
            "S3": [180, 225, 207, 54, 117, 134, 48, 240, 150, 154, 168, 180, 216, 153, 149, 174, 159, 213, 130, 125, 204, 56, 234, 165, 234, 231, 122, 102, 162, 126, 216, 231, 186, 156, 111, 183, 189, 150, 68, 195, 159, 240, 240, 27, 183, 165, 195, 116, 171, 234, 136, 171, 192, 171, 162, 152, 201, 70, 207, 162, 204, 154, 116, 121, 106, 94, 146, 38, 137, 136, 109, 54, 195, 174, 121, 109, 165, 53, 98, 210, 71, 132, 29, 39, 165, 21, 165, 216, 186, 207, 198, 117, 168, 213, 39, 29, 81, 171, 204, 35],
            "S4": [240, 102, 204, 189, 97, 183, 46, 162, 99, 222, 138, 97, 121, 174, 21, 70, 27, 150, 29, 43, 129, 79, 140, 228, 74, 143, 136, 153, 60, 40, 137, 152, 40, 58, 219, 26, 177, 29, 108, 142, 207, 183, 145, 84, 121, 168, 65, 162, 180, 180, 237, 87, 207, 168, 54, 246, 198, 159, 146, 213, 159, 177, 165, 177, 225, 195, 162, 174, 171, 234, 210, 186, 171, 210, 50, 153, 32, 54, 150, 216, 240, 219, 162, 145, 162, 231, 231, 153, 162, 183, 186, 32, 95, 142, 138, 171, 204, 249, 177, 171],
            "S5": [63, 51, 114, 168, 105, 215, 132, 123, 114, 156, 153, 174, 159, 159, 189, 156, 153, 150, 120, 39, 63, 174, 205, 204, 170, 93, 187, 87, 24, 93, 153, 96, 174, 180, 203, 93, 87, 51, 165, 120, 178, 96, 126, 178, 33, 156, 146, 219, 36, 200, 216, 147, 42, 129, 63, 150, 51, 171, 93, 138, 36, 45, 153, 216, 175, 158, 39, 218, 160, 168, 210, 194, 205, 30, 218, 156, 186, 156, 159, 126, 57, 194, 60, 179, 211, 99, 54, 69, 111, 218, 39, 114, 174, 154, 167, 51, 99, 168, 171, 153],
            "S6": [218, 103, 98, 57, 60, 75, 108, 108, 64, 202, 50, 148, 93, 91, 112, 157, 32, 117, 126, 152, 144, 31, 194, 154, 169, 132, 58, 70, 192, 81, 49, 125, 125, 53, 146, 86, 140, 98, 37, 53, 105, 79, 26, 108, 197, 121, 27, 106, 108, 145, 121, 96, 122, 160, 166, 159, 76, 109, 151, 49, 200, 27, 69, 172, 82, 181, 68, 202, 141, 184, 202, 172, 194, 180, 149, 167, 54, 166, 31, 145, 113, 153, 154, 161, 148, 139, 171, 105, 175, 193, 151, 91, 112, 162, 202, 89, 73, 75, 128, 198]
        }
        threshold = [105.0, 105.0]
        self.plot_box_plot(data=data, threshold=threshold, ylabel="Active links")

    def plot_box_plots_ttw(self):
        """
        Supervised vanilla
        data = {
            "S0": [2145.0, 1050.0, 3120.0, 624.0, 3417.0, 966.0, 3420.0, 2115.0, 2268.0, 1134.0, 2475.0, 1995.0, 3621.0, 2142.0, 1548.0, 1989.0, 900.0, 2856.0, 2220.0, 2688.0, 2475.0, 840.0, 2340.0, 780.0, 1848.0, 1836.0, 2628.0, 1938.0, 2046.0, 780.0, 3408.0, 2025.0, 780.0, 2484.0, 2145.0, 600.0, 2688.0, 546.0, 1680.0, 2322.0, 2925.0, 960.0, 3504.0, 2610.0, 1080.0, 2970.0, 2754.0, 1218.0, 4140.0, 2805.0, 855.0, 3735.0, 2052.0, 2295.0, 1518.0, 1980.0, 672.0, 3408.0, 2793.0, 2940.0, 2040.0, 3888.0, 495.0, 2262.0, 2262.0, 1716.0, 3135.0, 513.0, 3021.0, 3306.0, 1890.0, 2613.0, 1176.0, 3402.0, 1200.0, 2976.0, 1518.0, 1872.0, 1200.0, 3510.0, 1728.0, 2214.0, 1512.0, 4131.0, 495.0, 3690.0, 3021.0, 2394.0, 2145.0, 1674.0, 2340.0, 1944.0, 3762.0, 2400.0, 2016.0, 4050.0, 1512.0, 2898.0, 1134.0, 2436.0],
            "S1": [3120.0, 1872.0, 3315.0, 3978.0, 3825.0, 2160.0, 2106.0, 1650.0, 570.0, 3330.0, 2040.0, 930.0, 1560.0, 1210.0, 2856.0, 2436.0, 616.0, 2475.0, 1536.0, 2730.0, 2907.0, 2379.0, 1720.0, 2490.0, 2646.0, 1615.0, 4428.0, 2964.0, 3285.0, 3408.0, 2244.0, 969.0, 2190.0, 504.0, 4047.0, 2310.0, 1406.0, 3120.0, 1920.0, 1888.0, 1530.0, 4560.0, 4104.0, 2601.0, 3080.0, 2340.0, 1484.0, 3825.0, 1890.0, 2440.0, 730.0, 3444.0, 3216.0, 1620.0, 1020.0, 2964.0, 3003.0, 2394.0, 3312.0, 3477.0, 2520.0, 2336.0, 3825.0, 4161.0, 1830.0, 1160.0, 2310.0, 442.0, 2490.0, 595.0, 3744.0, 2106.0, 612.0, 2244.0, 1352.0, 3735.0, 1590.0, 2128.0, 2730.0, 2010.0, 1314.0, 2652.0, 1440.0, 3234.0, 3477.0, 3660.0, 1800.0, 2720.0, 2700.0, 1365.0, 4503.0, 2394.0, 1500.0, 2160.0, 735.0, 3660.0, 4047.0, 3081.0, 3648.0, 2070.0],
            "S2": [3074.4, 819.0, 2992.05, 2754.0, 4108.5, 624.0, 2823.84, 756.0, 4336.02, 1440.0, 3906.09, 2322.0, 2318.4, 720.0, 3531.6000000000004, 2028.0, 1740.0, 1380.0, 3889.4400000000005, 1806.0, 3536.4600000000005, 798.0, 4247.04, 1617.0, 2385.0, 4435.200000000001, 1350.0, 2798.4, 540.0, 1683.0000000000002, 363.0, 4959.360000000001, 2142.0, 336.0, 3846.1500000000005, 627.0, 2122.23, 2352.0, 1890.0, 2160.0, 2830.5000000000005, 1326.0, 2217.6000000000004, 504.0, 2397.6000000000004, 1287.0, 2321.7000000000003, 630.0, 2574.0, 1215.0, 2497.5, 1305.0, 3453.2100000000005, 396.0, 3636.36, 2160.0, 3516.4800000000005, 2268.0, 4280.43, 468.0, 2307.69, 1920.0, 3296.1600000000003, 2193.0, 2280.0, 3356.6400000000003, 3078.0, 2808.0, 2124.54, 900.0, 2788.5, 528.0, 5035.8, 1728.0, 2975.7000000000003, 2058.0, 2917.0800000000004, 1443.0, 3353.3100000000004, 2291.5200000000004, 2028.0, 2616.9, 1938.0, 2040.4800000000002, 1710.0, 1749.0, 4708.8, 1656.0, 4158.0, 2040.0, 4145.85, 408.0, 2701.02, 1584.0, 2919.84, 1020.0, 3067.6800000000003, 1440.0, 1890.0, 2244.0],
            "S3": [2727.2700000000004, 800.0, 3463.2000000000003, 948.0, 2069.76, 1548.0, 3564.0000000000005, 1089.0, 2772.0, 294.0, 4381.8, 2888.0, 4724.160000000001, 3020.0, 2160.0, 3188.6400000000003, 2100.0, 4717.4400000000005, 1088.0, 3170.1600000000003, 960.0, 1731.6000000000001, 520.0, 3413.88, 440.0, 4930.200000000001, 902.0, 2661.78, 1360.0, 2328.48, 1440.0, 3353.3100000000004, 1335.0, 2973.6000000000004, 2176.0, 1501.0, 3198.7200000000003, 407.0, 3628.8, 1768.0, 1914.0000000000002, 896.0, 3003.6600000000003, 1026.0, 1798.5000000000002, 585.0, 4555.4400000000005, 2432.0, 680.0, 2910.6000000000004, 1190.0, 3835.7100000000005, 2142.0, 3976.32, 780.0, 3029.4, 2400.0, 1088.0, 3463.2000000000003, 2780.0, 1342.0, 3729.6000000000004, 1744.0, 4795.200000000001, 385.0, 3543.1200000000003, 980.0, 4777.92, 1275.0, 1896.6000000000001, 1568.0, 2929.92, 396.0, 2580.4800000000005, 938.0, 2315.0400000000004, 1728.0, 3188.2500000000005, 2601.0, 2354.4, 806.0, 4224.0, 2465.0, 4502.400000000001, 1507.0, 2500.0, 1831.5000000000002, 544.0, 2223.6000000000004, 2320.0, 3247.2000000000003, 399.0, 1798.2, 1242.0, 3145.7400000000002, 1260.0, 4132.530000000001, 876.0, 2837.1600000000003, 1320.0],
            "S4": [2745.0, 3555.0, 4212.0, 2592.0, 1386.0, 3402.0, 2496.0, 674.8800000000001, 3774.0, 4674.0, 2484.0, 732.48, 3942.0, 4161.0, 3834.0, 2535.0, 319.0, 3192.0, 4500.0, 2700.0, 1310.4, 4374.0, 3834.0, 3402.0, 3240.0, 2190.0, 1971.2000000000003, 2304.0, 1756.16, 3762.0, 2544.0, 2928.0, 3150.0, 2808.0, 2028.0, 2280.0, 1587.0400000000002, 3984.0, 3120.0, 3402.0, 2040.0, 389.13000000000005, 4674.0, 4500.0, 1872.0, 2688.0, 2045.7300000000002, 2736.0, 3840.0, 2100.0, 3176.8, 1989.0, 2580.4800000000005, 648.5500000000001, 3984.0, 2475.0, 1215.45, 1530.0, 1573.96, 3468.0, 4731.0, 3120.0, 2436.0, 1552.3200000000002, 4275.0, 2475.0, 2302.0800000000004, 2304.0, 560.0, 3000.0, 4980.0, 3936.0, 2484.0, 1569.6000000000001, 1988.16, 2880.0, 3120.0, 3645.0, 3792.0, 2808.0, 2400.0, 1500.72, 3000.0, 2805.0, 3720.0, 3780.0, 2430.0, 461.76000000000005, 2880.0, 1530.0, 3168.63, 2640.0, 2331.0, 2295.54, 2400.0, 2051.28, 924.0000000000001, 2886.0, 2196.0, 2149.48],
            "S5": [3000.0, 1377.0, 4040.4000000000005, 2262.0, 3170.1600000000003, 2565.0, 3192.0, 1764.0, 588.0, 2616.0, 1320.0, 2524.44, 1089.0, 2688.42, 1440.0, 2431.0, 3240.0, 2160.0, 2160.0, 2780.55, 2280.0, 2909.21, 1344.0, 2692.3, 1776.0, 3330.0000000000005, 936.0, 2402.4, 2256.0, 2624.0400000000004, 3021.0, 1663.2, 1728.0, 2425.5, 2550.0, 690.0, 3852.0600000000004, 1125.0, 3936.0600000000004, 1710.0, 2262.0, 945.0, 2153.84, 1833.0, 1485.0, 3503.36, 2295.0, 3135.0, 1008.0, 1996.5000000000002, 2016.0, 2448.0, 1680.0, 1601.6000000000001, 1242.0, 2168.32, 1938.0, 2388.1000000000004, 756.0, 3729.6000000000004, 2460.0, 480.0, 2656.5, 714.0, 2455.32, 2793.0, 1638.0, 759.0, 3896.1000000000004, 810.0, 2300.48, 2271.0600000000004, 540.0, 3175.2000000000003, 756.0, 2582.9700000000003, 1665.0, 3762.0000000000005, 2907.0, 4306.8, 819.0, 2703.2000000000003, 2296.0, 1044.0, 3280.2000000000003, 1800.0, 2601.0, 1536.0, 2151.6000000000004, 1053.0, 3991.9000000000005, 969.0, 2828.28, 1440.0, 1891.44, 1771.0000000000002, 819.0, 2016.0000000000002, 3300.0, 2340.0],
            "S6": [1327.2, 2445.96, 1587.0400000000002, 2735.0400000000004, 1663.2, 3104.6400000000003, 2050.29, 3928.36, 807.69, 2436.0000000000005, 1630.7200000000003, 2430.9, 369.6, 4394.88, 1053.39, 3836.1600000000003, 295.68, 2575.2000000000003, 1601.6000000000001, 3777.4, 453.44000000000005, 4213.4400000000005, 1901.9, 1089.0, 2930.4, 1953.2800000000002, 2649.9, 456.96000000000004, 4599.8, 2237.4, 4514.400000000001, 1883.5200000000002, 2150.4, 4058.07, 1988.16, 443.52000000000004, 3903.2000000000003, 430.08000000000004, 3225.6000000000004, 751.5200000000001, 3798.65, 1110.0, 2956.8, 2659.8, 1293.6000000000001, 2897.44, 302.40000000000003, 3720.2000000000003, 882.9000000000001, 3413.2500000000005, 1628.0000000000002, 2580.4800000000005, 1656.8000000000002, 1393.0200000000002, 2092.8, 1245.42, 1878.1200000000001, 1747.2000000000003, 1320.0, 3487.6800000000003, 2303.84, 3784.0000000000005, 1863.6800000000003, 4451.700000000001, 1793.7600000000002, 2661.1200000000003, 2557.44, 2741.76, 2983.6800000000003, 3712.8, 1276.8000000000002, 2550.6000000000004, 2360.96, 2439.36, 2834.0, 603.84, 3197.7000000000003, 3161.28, 1072.5, 3500.9400000000005, 2835.09, 2913.7500000000005, 2029.5800000000002, 2377.76, 515.2, 4242.700000000001, 1771.5600000000002, 1465.2, 1212.1200000000001, 3085.6000000000004, 1364.0, 1887.6000000000001, 2800.6000000000004, 1787.5200000000002, 632.7, 3971.0000000000005, 1309.8000000000002, 2562.5600000000004, 2154.88, 1474.0800000000002]
        }
        """
        # Unsupervised vanilla
        data = {
            "S0": [1482.0, 840.0, 3168.0, 1920.0, 2976.0, 1458.0, 1881.0, 1650.0, 969.0, 3264.0, 2544.0, 1536.0, 2100.0, 864.0, 3159.0, 675.0, 3477.0, 2262.0, 2754.0, 1836.0, 3555.0, 1710.0, 2814.0, 675.0, 4131.0, 918.0, 2340.0, 1512.0, 2451.0, 4158.0, 3120.0, 510.0, 2652.0, 1224.0, 4320.0, 1998.0, 2070.0, 1584.0, 1560.0, 1980.0, 1872.0, 1482.0, 3600.0, 1968.0, 4389.0, 2028.0, 3990.0, 1053.0, 3417.0, 972.0, 2340.0, 2916.0, 3009.0, 2907.0, 2295.0, 1650.0, 540.0, 2460.0, 2565.0, 936.0, 3744.0, 429.0, 3135.0, 3132.0, 2862.0, 2679.0, 513.0, 1815.0, 1368.0, 1800.0, 2700.0, 660.0, 2220.0, 1980.0, 3300.0, 1653.0, 2088.0, 1350.0, 3360.0, 1353.0, 2673.0, 2262.0, 1320.0, 3330.0, 378.0, 3978.0, 576.0, 3942.0, 1680.0, 1770.0, 714.0, 3735.0, 351.0, 2508.0, 2805.0, 972.0, 2640.0, 1200.0, 4047.0, 1680.0],
            "S1": [1848.0, 3456.0, 640.0, 2124.0, 420.0, 1650.0, 2680.0, 1045.0, 1950.0, 1746.0, 1568.0, 406.0, 1378.0, 1529.0, 3942.0, 1944.0, 1560.0, 551.0, 494.0, 1639.0, 2646.0, 2736.0, 2970.0, 357.0, 1824.0, 480.0, 972.0, 860.0, 714.0, 1716.0, 3876.0, 867.0, 1215.0, 1872.0, 1414.0, 1836.0, 2145.0, 3015.0, 1900.0, 1090.0, 3540.0, 540.0, 3040.0, 2100.0, 930.0, 990.0, 658.0, 2299.0, 2280.0, 600.0, 1026.0, 1696.0, 1620.0, 714.0, 294.0, 3477.0, 1212.0, 1184.0, 378.0, 1180.0, 2698.0, 3618.0, 2860.0, 760.0, 3780.0, 1836.0, 3990.0, 2196.0, 1488.0, 368.0, 4380.0, 3420.0, 1368.0, 910.0, 3042.0, 1106.0, 648.0, 2299.0, 4140.0, 1716.0, 1980.0, 767.0, 1105.0, 2907.0, 2142.0, 1080.0, 2527.0, 1482.0, 1580.0, 408.0, 2414.0, 2260.0, 564.0, 1740.0, 4800.0, 2016.0, 2370.0, 2430.0, 4080.0, 2301.0],
            "S2": [4597.62, 3836.1600000000003, 459.0, 2623.5, 3306.2400000000002, 1716.0, 2697.3, 741.0, 2160.0, 3383.5200000000004, 2625.8100000000004, 1692.0, 2970.0, 2417.5800000000004, 495.0, 2256.0, 1881.0, 2178.0, 3696.0000000000005, 1224.0, 1584.0, 4012.8, 2376.0, 1650.0, 2376.0, 2091.0, 792.0, 2331.0, 1560.0, 3226.7700000000004, 2592.0, 3067.6800000000003, 2328.48, 1665.0, 3432.0000000000005, 2205.0, 3319.6800000000003, 1050.0, 630.0, 1209.0, 4473.360000000001, 360.0, 4870.8, 2317.6800000000003, 1887.0, 2346.0, 1344.0, 4528.8, 2755.2000000000003, 3929.4000000000005, 528.0, 2874.3, 3440.6400000000003, 2564.1000000000004, 858.0, 1932.0, 4300.8, 2544.0, 2359.5, 2601.0, 1728.0, 1395.0, 1131.0, 867.0, 2100.0, 2797.2000000000003, 1440.0, 1950.0, 912.0, 3247.2000000000003, 4885.38, 3273.6000000000004, 1656.0, 1332.0, 1914.0, 2703.0, 5171.040000000001, 3024.0000000000005, 2550.2400000000002, 3034.5600000000004, 3396.6000000000004, 3729.6000000000004, 1617.0, 756.0, 2257.92, 4502.400000000001, 3448.5000000000005, 3415.5000000000005, 2217.6000000000004, 855.0, 3914.1900000000005, 510.0, 408.0, 855.0, 2835.09, 1173.0, 1665.0, 2340.0, 2166.0, 2900.4300000000003],
            "S3": [1500.0, 406.0, 1210.0, 836.0, 2983.6800000000003, 644.0, 2046.0000000000002, 384.0, 2368.0, 680.0, 572.0, 4075.9200000000005, 1962.0000000000002, 4765.200000000001, 1050.0, 4381.8, 2336.0, 2131.2000000000003, 1924.0, 720.0, 2688.0000000000005, 4636.8, 1104.0, 2160.0, 784.0, 870.0, 1160.0, 1173.0, 2661.1200000000003, 1534.0, 2085.0, 2664.0000000000005, 2517.48, 4316.400000000001, 1210.0, 3796.2000000000003, 2085.0, 1620.0, 3128.4, 4735.26, 5346.0, 4028.6400000000003, 2976.6000000000004, 460.0, 1488.0, 3983.1000000000004, 4058.07, 696.0, 1140.0, 910.0, 1575.0, 4002.4800000000005, 4368.96, 5577.6, 1860.0, 2384.0, 2466.0, 860.0, 3335.4, 253.0, 3246.7500000000005, 952.0, 2376.0, 952.0, 3616.6200000000003, 1480.0, 3415.5000000000005, 2698.0800000000004, 640.0, 1260.0, 1400.0, 3580.65, 1716.0, 2310.0, 336.0, 3816.9600000000005, 3504.6000000000004, 2184.0, 1920.0, 1254.0, 3076.92, 874.0, 546.0, 2210.0, 2888.0, 1012.0, 700.0, 4492.17, 510.0, 1116.0, 2847.15, 1936.0, 450.0, 1276.0, 2100.0, 2040.4800000000002, 3237.3, 2822.4, 470.0, 3403.26],
            "S4": [3360.0, 3135.0, 1914.0, 4158.0, 2430.0, 3213.0, 2250.0, 2970.0, 2475.0, 1944.0, 1552.3200000000002, 1684.0500000000002, 1275.3000000000002, 4440.0, 3477.0, 2607.0, 2040.0, 2844.9, 419.58000000000004, 1094.46, 2856.0, 1678.3200000000002, 1921.92, 3159.0, 2880.0, 2003.5500000000002, 645.2800000000001, 3504.0, 1354.2, 1953.2800000000002, 2652.0, 3132.0, 2190.0, 3120.0, 1185.48, 2745.0, 924.0000000000001, 3360.0, 2601.0, 2481.6000000000004, 4374.0, 1989.0, 2457.0, 1463.0000000000002, 1819.2900000000002, 1287.0, 1904.0000000000002, 1773.2, 3176.8, 2310.0, 1569.6000000000001, 2040.0, 1411.2, 319.0, 1651.1000000000001, 457.8, 382.8, 4380.0, 2520.0, 3519.0, 1098.72, 2201.8, 3060.0, 2453.1000000000004, 616.0000000000001, 2928.0, 3024.0, 3249.0, 1740.0, 3996.0, 3468.0, 1770.0, 2070.0, 3648.0, 3360.0, 3402.0, 3510.0, 777.0000000000001, 4233.0, 739.2, 3705.0, 1747.2000000000003, 2010.0, 2837.27, 1590.0, 3360.0, 287.76000000000005, 4617.0, 3468.0, 1785.42, 2646.0, 837.1200000000001, 3510.0, 1195.0400000000002, 1758.2400000000002, 1708.2900000000002, 1360.3200000000002, 2544.0, 2447.55, 3420.0],
            "S5": [510.0, 2808.0, 3249.0, 1566.0, 1728.0, 3000.0, 1215.0, 2565.0, 1296.0, 1620.0, 2805.0, 1584.0, 2448.0, 2616.9, 1320.0, 336.0, 1020.0, 2451.0, 1155.0, 1584.0000000000002, 1653.0, 2266.11, 3226.7700000000004, 459.0, 504.0, 1548.0, 1248.0, 4403.6, 1590.0, 1989.0, 2610.7200000000003, 3180.0, 3208.8, 855.0, 2566.9500000000003, 3830.4000000000005, 1938.0, 3153.92, 3557.76, 1895.0400000000002, 990.0, 693.0, 1224.0, 3553.76, 3225.6000000000004, 2508.0, 3330.0000000000005, 2106.0, 3135.0, 1287.0, 1890.0, 672.0, 600.0, 2393.6000000000004, 1560.0, 585.0, 2220.0, 2822.4, 1050.0, 1155.0, 3731.2000000000003, 2766.1200000000003, 2936.6400000000003, 2907.0, 3987.2000000000003, 840.0, 264.0, 2970.0000000000005, 2575.67, 2189.0, 3088.8, 1140.0, 2652.0, 2048.2000000000003, 2398.0, 576.0, 1884.9600000000003, 3019.5000000000005, 4151.400000000001, 2600.4, 2052.0, 3808.0000000000005, 1584.0, 1705.0000000000002, 1998.0, 3433.5000000000005, 3088.8, 2100.0, 2821.5000000000005, 918.0, 594.0, 2904.8500000000004, 1377.0, 2020.7000000000003, 1998.0000000000002, 2023.8400000000001, 2990.4, 2973.69, 3962.7000000000003, 4107.0],
            "S6": [946.0000000000001, 1408.0, 640.9200000000001, 2646.5600000000004, 1306.8000000000002, 1544.5300000000002, 2536.4300000000003, 2125.2000000000003, 425.1, 799.6800000000001, 2469.6000000000004, 1395.2, 1317.1200000000001, 3084.4800000000005, 486.20000000000005, 1413.0300000000002, 1097.63, 1989.1200000000001, 1443.0000000000002, 2675.2000000000003, 2628.48, 2841.6000000000004, 564.48, 2613.6000000000004, 668.22, 294.3, 4817.8, 763.0, 2271.36, 880.0000000000001, 3167.36, 1881.0000000000002, 1417.0, 1500.8000000000002, 4215.780000000001, 3313.6000000000004, 1064.8000000000002, 1225.44, 1108.8000000000002, 1587.3000000000002, 4473.360000000001, 2770.5600000000004, 1387.5000000000002, 2424.1600000000003, 2917.0800000000004, 571.2, 588.6, 4417.8, 2494.8, 640.9200000000001, 1227.66, 710.4000000000001, 1161.44, 2734.6000000000004, 2035.7400000000002, 1948.8000000000002, 2877.1200000000003, 1421.2, 1792.65, 2286.6000000000004, 1098.72, 2511.36, 1908.4800000000002, 1344.2, 323.73, 436.00000000000006, 803.33, 1151.0700000000002, 1155.4, 2040.4800000000002, 2884.1400000000003, 3080.0000000000005, 4972.8, 1580.3200000000002, 1585.92, 770.0000000000001, 1245.42, 1444.8000000000002, 2373.28, 2583.3, 2588.75, 1848.0000000000002, 941.7600000000001, 648.5500000000001, 1761.7600000000002, 2468.4, 3196.8, 3356.6400000000003, 2499.84, 1771.8400000000001, 2741.7000000000003, 1915.2000000000003, 2220.0, 1191.68, 2376.0, 355.20000000000005, 1468.5000000000002, 1847.5500000000002, 704.0, 1509.2]
        }

        # unsupervised with novelty
        data = {
            "S0": [1026.0, 912.0, 1560.0, 1716.0, 2040.0, 2016.0, 1260.0, 891.0, 972.0, 1770.0, 2730.0, 1530.0, 2160.0, 2835.0, 363.0, 630.0, 924.0, 1932.0, 1425.0, 1134.0, 1794.0, 1872.0, 1632.0, 2250.0, 1911.0, 1848.0, 2343.0, 1254.0, 240.0, 1980.0, 2808.0, 2460.0, 2400.0, 1740.0, 2394.0, 810.0, 1890.0, 432.0, 3009.0, 1344.0, 2964.0, 429.0, 459.0, 1770.0, 1680.0, 585.0, 1920.0, 780.0, 1080.0, 330.0, 1560.0, 2040.0, 2475.0, 3024.0, 1080.0, 546.0, 1920.0, 459.0, 4731.0, 1680.0, 3648.0, 504.0, 1350.0, 1311.0, 1260.0, 1380.0, 2592.0, 1512.0, 2310.0, 1116.0, 891.0, 1080.0, 1209.0, 1734.0, 2160.0, 2214.0, 1404.0, 1815.0, 1551.0, 1740.0, 2541.0, 2907.0, 2430.0, 3996.0, 297.0, 3150.0, 2964.0, 2145.0, 768.0, 1824.0, 2160.0, 4731.0, 918.0, 1944.0, 2280.0, 561.0, 2262.0, 2640.0, 2400.0, 1782.0],
            "S1": [368.0, 1207.0, 1620.0, 1105.0, 1428.0, 3444.0, 1008.0, 2376.0, 1224.0, 2190.0, 480.0, 231.0, 3015.0, 561.0, 1088.0, 1375.0, 2190.0, 2109.0, 560.0, 2958.0, 1938.0, 1462.0, 2100.0, 2832.0, 4380.0, 2394.0, 759.0, 1742.0, 1703.0, 3285.0, 4020.0, 2508.0, 1045.0, 1064.0, 480.0, 3876.0, 3840.0, 2409.0, 3444.0, 2736.0, 525.0, 399.0, 2475.0, 4617.0, 3360.0, 1653.0, 2166.0, 816.0, 750.0, 1377.0, 1632.0, 2394.0, 2130.0, 2299.0, 1260.0, 1521.0, 1989.0, 2015.0, 1935.0, 2610.0, 2835.0, 1422.0, 2124.0, 1792.0, 968.0, 2240.0, 2600.0, 3285.0, 2142.0, 1441.0, 1400.0, 4503.0, 806.0, 1560.0, 1616.0, 3360.0, 1944.0, 3015.0, 1080.0, 798.0, 4389.0, 1824.0, 1290.0, 2058.0, 4233.0, 1088.0, 731.0, 1859.0, 3876.0, 360.0, 1904.0, 1168.0, 510.0, 1800.0, 4674.0, 1620.0, 3300.0, 2628.0, 736.0, 2363.0],
            "S2": [1122.0, 1776.0, 2052.0, 627.0, 3376.8, 1599.0, 957.0, 1920.0, 660.0, 594.0, 627.0, 1521.0, 1995.8400000000001, 2565.0, 2141.7000000000003, 408.0, 1860.0, 588.0, 4462.200000000001, 4155.84, 3433.5000000000005, 2857.1400000000003, 1221.0, 3480.0, 1980.0, 2772.0, 3528.0000000000005, 4890.6, 1350.0, 1638.0, 297.0, 3712.8, 4224.84, 720.0, 1716.0, 1290.0, 3479.28, 384.0, 270.0, 1872.0, 1683.0, 2577.3, 1683.0, 1008.0, 5328.000000000001, 1680.0, 3960.0000000000005, 663.0, 1716.0, 2275.92, 1632.0, 1050.0, 3310.0200000000004, 2652.0, 4502.400000000001, 3168.63, 2096.6400000000003, 969.0, 2197.8, 561.0, 2851.2000000000003, 2564.1000000000004, 1692.0, 4702.5, 4276.8, 912.0, 864.0, 2592.0, 1221.0, 4055.5200000000004, 2322.0, 3646.5000000000005, 960.0, 1368.0, 3385.8, 600.0, 3643.2000000000003, 2703.0, 1260.0, 912.0, 2302.0800000000004, 1071.0, 5346.0, 1410.0, 3597.0000000000005, 4158.0, 2754.0, 3326.4, 1755.0, 2943.7200000000003, 1320.0, 1512.0, 2970.0, 864.0, 1221.0, 2465.5800000000004, 1824.0, 819.0, 1848.0, 1680.0],
            "S3": [3396.6000000000004, 2747.2500000000005, 4404.96, 540.0, 1638.0, 1474.0, 528.0, 4032.0000000000005, 2640.0, 2310.0, 3386.88, 3596.4, 3386.88, 2448.0, 1639.0, 2086.26, 2647.3500000000004, 3482.55, 1300.0, 1625.0, 2244.0, 840.0, 3088.8, 2541.0, 4717.4400000000005, 3846.1500000000005, 2196.0, 1632.0, 2673.0, 1386.0, 4596.4800000000005, 2517.9, 4092.0000000000005, 3116.88, 1443.0, 3484.32, 3742.2000000000003, 2550.0, 1088.0, 2338.05, 2426.34, 3168.0000000000005, 2640.0, 405.0, 2992.05, 3597.0000000000005, 2574.0, 1392.0, 3009.6000000000004, 4935.06, 1496.0, 2609.46, 2344.32, 3355.0200000000004, 2118.96, 1824.0, 3505.44, 980.0, 2757.2400000000002, 2697.3, 4528.8, 1694.0, 1276.0, 1936.0, 1378.0, 1692.0, 2482.0, 418.0, 2740.0, 2312.0, 1744.0, 1026.0, 3057.6000000000004, 2124.54, 2178.0, 1962.0, 3085.5000000000005, 689.0, 1764.0, 2975.7000000000003, 1349.0, 1848.0, 522.0, 741.0, 2956.8, 273.0, 2217.6000000000004, 3836.1600000000003, 2659.8, 3216.78, 4213.4400000000005, 1170.0, 2610.7200000000003, 3983.1000000000004, 468.0, 580.0, 1458.0, 2633.4, 4039.2000000000003, 630.0],
            "S4": [3600.0, 1132.2, 4080.0, 3780.0, 1738.2400000000002, 2196.0, 714.84, 2592.0, 1868.13, 2886.0, 2884.2000000000003, 1846.88, 1880.3400000000001, 2088.0, 376.32000000000005, 1320.9, 449.55, 2700.0, 519.6800000000001, 946.0000000000001, 1546.71, 1377.76, 2594.2000000000003, 2508.0, 814.0000000000001, 2202.2000000000003, 2393.6000000000004, 3060.0, 1122.0, 888.0000000000001, 2090.6200000000003, 3344.0000000000005, 440.00000000000006, 901.32, 2190.0, 495.04, 2301.0, 482.85, 1693.44, 1908.4800000000002, 2277.0, 1830.0, 3161.0000000000005, 1108.8000000000002, 1761.7600000000002, 2856.0, 1358.5, 3240.0, 2160.0, 2160.0, 4503.0, 957.0000000000001, 3933.0, 2016.0, 665.2800000000001, 3936.0, 1980.0, 1749.0, 2755.0200000000004, 2769.0, 1908.0, 2124.0, 1980.0, 1947.0, 3150.0, 2535.0, 1944.0, 2610.0, 2565.0, 3510.0, 2730.0, 2604.0, 2736.0, 3360.0, 555.0, 2907.0, 697.6, 604.8000000000001, 2100.0, 2592.0, 2640.0, 2190.0, 1782.0, 3248.0000000000005, 1782.0, 3927.0, 3234.0, 2835.09, 3078.0, 3660.0, 2976.0, 537.6, 1463.0000000000002, 2321.7000000000003, 1669.8000000000002, 3420.0, 2448.0, 2490.0, 2301.0, 3420.0],
            "S5": [1134.0, 663.0, 1482.0, 3024.0, 1785.0, 4218.3, 1848.0, 2460.0, 1824.0, 2496.0, 2142.0, 2436.0, 2067.0, 1908.0, 3090.15, 1887.6000000000001, 2377.6200000000003, 2100.0, 1680.0, 702.0, 819.0, 2262.0, 2984.8, 4075.9200000000005, 1887.0000000000002, 1674.0, 3113.55, 1131.0, 408.0, 1116.0, 2334.78, 1632.0, 1914.0, 1980.0000000000002, 4506.6, 1581.0, 1044.0, 816.0, 2805.0, 1800.0, 2192.96, 1248.0, 2520.0, 3987.2000000000003, 429.0, 2808.0, 2452.8, 2430.9, 468.0, 3706.0000000000005, 3836.1600000000003, 1778.7, 756.0, 2193.0, 1260.0, 2850.0, 663.0, 3249.0, 930.0, 1700.16, 396.0, 720.0, 2295.0, 2419.2000000000003, 3496.5000000000005, 2780.8, 741.0, 3629.7000000000003, 3168.0000000000005, 2856.0, 4389.0, 2987.6000000000004, 2480.5, 600.0, 4277.160000000001, 2028.0, 3303.36, 2808.0, 1908.0, 1386.0, 741.0, 2987.6000000000004, 660.0, 2559.7000000000003, 2363.2000000000003, 990.0, 810.0, 897.0, 2109.0, 4597.620000000001, 468.0, 1824.0, 2958.0, 3247.86, 1820.3000000000002, 714.0, 1683.0, 1848.0000000000002, 2907.0, 2754.0],
            "S6": [3836.8, 2020.8600000000001, 1865.92, 1065.9, 792.0000000000001, 1332.0000000000002, 1294.92, 1558.44, 1408.0, 2690.6400000000003, 943.5000000000001, 1657.6000000000001, 1926.0300000000002, 1801.8000000000002, 2007.0400000000002, 3422.6000000000004, 568.32, 2207.7900000000004, 1411.2, 2485.2000000000003, 2237.76, 375.1, 2607.36, 2564.1000000000004, 3684.2000000000003, 1726.5600000000002, 893.2, 1373.4, 2150.4, 989.0100000000001, 700.7, 2636.2500000000005, 1387.5000000000002, 932.8000000000001, 2917.0800000000004, 1830.0800000000002, 2952.6000000000004, 1414.14, 616.0500000000001, 751.0100000000001, 1144.5, 1315.3500000000001, 490.62000000000006, 2118.96, 4079.8700000000003, 1318.9, 599.4000000000001, 1662.0800000000002, 1678.3200000000002, 1595.0000000000002, 2395.8, 1397.7600000000002, 2596.1600000000003, 1760.0000000000002, 2008.6000000000001, 1780.8000000000002, 1106.5600000000002, 1831.2000000000003, 3155.9, 862.4000000000001, 4032.0000000000005, 509.49000000000007, 1278.5700000000002, 1926.4, 1262.8000000000002, 2389.2000000000003, 754.8000000000001, 3555.2000000000003, 2326.5, 2679.0400000000004, 2941.1200000000003, 3594.8, 2748.98, 3225.6000000000004, 2130.7000000000003, 3522.03, 907.2, 3160.6400000000003, 694.4000000000001, 2111.2000000000003, 2151.52, 3226.7700000000004, 2242.2400000000002, 3334.3100000000004, 2279.2000000000003, 2622.9300000000003, 3416.5800000000004, 2060.1000000000004, 3052.0, 2356.53, 3016.9800000000005, 1901.9, 1881.6000000000001, 2648.7000000000003, 2888.6000000000004, 1067.1100000000001, 1113.98, 1635.0000000000002, 2841.6000000000004, 4138.200000000001]
        }
        threshold = [2700.0, 2700.0]
        self.plot_box_plot(data=data, threshold=threshold, ylabel="Time to write")

    def plot_box_plot(self, data, threshold, ylabel):
        df = pd.DataFrame(data)
        plt.plot([0, config.time_steps - 1], threshold, color="red", label="Satisfaction threshold")
        ax = df.plot(kind='box', patch_artist=True)
        plt.setp(ax.lines, color='black')
        plt.axhline(y=threshold[0], color='r', linestyle='-', label="Satisfaction threshold", linewidth=3)

        plt.xlabel("Scenario")
        plt.ylabel(ylabel)

        ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.1),
                  ncol=3, fancybox=True, shadow=True)
        plt.show()

    def plot_novelty_surprise_correction(self):
        plt.plot(self.pomdp.states_surprise_log, label="Surprise")
        plt.plot(self.pomdp.novelty_log, label="Novelty")
        plt.xlabel("Time")
        plt.title(f"{self.get_scenario_label()} {self.get_pomdp_label()} Novelty vs Surprise")
        plt.legend(loc="upper left")
        plt.show()

    def plot_scenario_actions_chosen_bar_charts(self):
        # supervised vanilla
        data = {
            "S0": [58, 42],
            "S1": [31, 69],
            "S2": [53, 47],
            "S3": [52, 48],
            "S4": [29, 71],
            "S5": [55, 45],
            "S6": [56, 44]
        }

        """
        # unsupervised vanilla
        data = {
            "S0": [58, 42], # redo?
            "S1": [68, 32], # reward: 3103
            "S2": [54, 46],  # reward: 3371
            "S3": [59, 41],  # reward: 3332
            "S4": [43, 57],  # reward: 3202
            "S5": [55, 45],  # reward: 3268
            "S6": [70, 30]  # reward: 2951
        }
        """

        """
        # unsupervised with novelty
        data = {
            "S0": [75, 25],
            "S1": [65, 35],
            "S2": [63, 37],
            "S3": [46, 54],
            "S4": [44, 56],
            "S5": [64, 36],
            "S6": [62, 38]
        }
        """
        fig, ax = plt.subplots()
        mst_chosen = [x[0] for x in data.values()]
        rt_chosen = [x[1] for x in data.values()]

        index = np.arange(len(data))
        bar_width = 0.35

        bar1 = ax.bar(index - bar_width/2, mst_chosen, bar_width, label="MST chosen")
        bar2 = ax.bar(index + bar_width/2, rt_chosen, bar_width, label="RT chosen")
        ax.set_xlabel("Scenario")
        ax.set_ylabel("Frequency")
        ax.set_xticks(np.arange(0, 7))
        ax.set_xticklabels(data.keys())
        ax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.1),
                  ncol=3, fancybox=True, shadow=True)
        plt.tight_layout()
        plt.show()

